{% extends 'base.html' %}

{% block title %}<title>{{ SITENAME }} - The River</title>{% endblock %}

{% block script %}
  {% load dajaxice_templatetags %}
  {% dajaxice_js_import %}
  <script async="" src="http://platform.twitter.com/widgets.js" charset="utf-8"></script>
  <script src="{{ STATIC_URL }}js/embed.js" language="javascript" type="text/javascript"></script>
{% endblock %}

{% block content %}
<div class="body wide">
  <div class="content">
    <div class="right">
      <p>Display:</p>
      <small>
        <table>
          <tr>
            <td><label title="Coming Soon" for="facebook-toggle">Facebook</label></td>
            <td><input title="Coming Soon" id="facebook-toggle" disabled name="facebook-toggle" type="checkbox" onclick="toggleDisplay('facebook')"/></td>
            <td class="table-pad"></td>
            <td><label for="flickr-toggle">Flickr</label></td>
            <td><input id="flickr-toggle" name="flickr-toggle" type="checkbox" checked="checked" onclick="toggleDisplay('flickr')"/></td>
          </tr>
          <tr>
            <td><label for="github-toggle">Github</label></td>
            <td><input id="github-toggle" name="github-toggle" type="checkbox" onclick="toggleDisplay('github')"/></td>
            <td class="table-pad"></td>
            <td><label title="Coming Soon" for="imgur-toggle">Imgur</label></td>
            <td><input title="Coming Soon" id="imgur-toggle" disabled name="imgur-toggle" type="checkbox" onclick="toggleDisplay('imgur')"/></td>
          </tr>
          <tr>
            <td><label for="lastfm-toggle">LastFm</label></td>
            <td><input id="lastfm-toggle" name="lastfm-toggle" type="checkbox" onclick="toggleDisplay('lastfm')"/></td>
            <td class="table-pad"></td>
            <td><label for="soundcloud-toggle">Soundcloud</label></td>
            <td><input id="soundcloud-toggle" name="soundcloud-toggle" type="checkbox" onclick="toggleDisplay('soundcloud')"/></td>
          </tr>
          <tr>
            <td><label for="blog-toggle">Blog</label></td>
            <td><input id="blog-toggle" name="blog-toggle" type="checkbox" onclick="toggleDisplay('blog')"/></td>
            <td class="table-pad"></td>
            <td><label for="twitter-toggle">Twitter</label></td>
            <td><input id="twitter-toggle" name="twitter-toggle" type="checkbox" checked="checked" onclick="toggleDisplay('twitter')"/></td>
          </tr>
        </table>
      </small>
    </div>
    <h1>The River</h1>
    <small>A collection of my most prominent activity streams.</small>

    <noscript>
      <p>You need to enable Javascript for this to work.</p>
    </noscript>
    <div class="clear"></div>
  </div>
  {% comment %}
  <div class="content inbetween"></div>

  <div class="content">
    {% if embeds %}
      <ul class="oembedded">
        {% for embed in embeds %}
          {% if embed.type == "lastfm" %}
            <li class="embedsimple lastfmbg">
              <div class="right">
                {% if embed.nowplaying %}
                  <i class="lastfmnp">Now Playing!</i>
                {% else %}
                  Recently listened to
                {% endif %}
                on <a href="http://last.fm/user/{{ USERNAME }}">Last.fm</a>
              </div>
              <a href="{{ embed.url }}">{{ embed.name }} - {{ embed.artist }}</a>
              <div class="clear"></div>
            </li>
          {% elif embed.type == "soundcloud" %}
            <li class="embedsc soundcloudbg">{{ embed.html|safe }}</li>
          {% elif embed.type == "flickr" %}
            <li class="embedflickr flickrbg">
              <a href="http://flickr.com/photos/{{ USERNAME }}/{{ embed.photoid }}"><img class="right" src="{{ embed.imgsrc }}" /></a>
              <div class="flickrdesc">
                  {% if embed.title %}
                    <a href="http://flickr.com/photos/{{ USERNAME }}/{{ embed.photoid }}"><h3>{{ embed.title }}</h3></a>
                  {% endif %}
                  {% if embed.description %}
                    <div class="flickrdesc">{{ embed.description|safe }}</div>
                  {% endif %}
                <div>From <a href="http://flickr.com/{{ USERNAME }}">Flickr</a></div>
              </div>
              <div class="clear"></div>
            </li>
          {% elif embed.type == "github" %}
            <li class="embedsimple githubbg">
              <div class="right">
                From <a href="http://github.com/{{ USERNAME }}">GitHub</a>
              </div>
              {% if embed.event_type == "PushEvent" %}
                {% for commit in embed.payload.commits %}
                  <a href="{{ embed.repo_url }}/commit/{{ commit.sha }}"><i>{{ commit.sha }}</i></a>:
                  <p class="space">{{ commit.message }}</p>
                {% endfor %}
                <p>Pushed to <a href="{{ embed.repo_url }}">{{ embed.repo.name }}</a></p>
              {% elif embed.event_type == "WatchEvent" %}
                <p>Started watching <a href="{{ embed.repo_url }}">{{ embed.repo.name }}</a></p>
              {% elif embed.event_type == "CreateEvent" %}
                <p>
                  Created new {{ embed.payload.ref_type }}: <i>{{ embed.payload.ref }}</i>
                  {% if embed.payload.description %}
                    <p class="space">{{ embed.payload.description }}</p>
                  {% endif %}
                </p>
                On <a href="{{ embed.repo_url }}">{{ embed.repo.name }}</a>
              {% elif embed.event_type == "CommitCommentEvent" %}
                <p>
                  Commented on commit <a href="{{ embed.payload.comment.html_url }}">{{ embed.payload.comment.commit_id }}</a>:
                  <p class="space">{{ embed.payload.comment.body }}</p>
                </p>
              {% elif embed.event_type == "GollumEvent" %}
                <p>
                  Edited
                  <p class="space">
                    {% for page in embed.payload.pages %}
                      <p><a href="{{ page.html_url }}">{{ page.title }}</a></p>
                    {% endfor %}
                  </p>
                  On <a href="{{ embed.repo_url }}">{{ embed.repo.name }}</a>
                </p>
              {% else %}
                <p>Did some GitHub activity</p>
              {% endif %}
              <div class="clear"></div>
            </li>
          {% elif embed.type == "twitter" %}
            <li class="embedsimple twitterbg">{{ embed.html|safe }}</li>
          {% else %}
            <li class="embedsimple embedsimplebg">{{ embed.html|safe }}</li>
          {% endif %}
        {% endfor %}
      </ul>
    {% endif %}
  </div>
  {% endcomment %}

  <div class="content inbetween"></div>

  <div class="content">
    <div id="hide" class="aligncenter">
      <img class="aligncenter" src="{{ STATIC_URL }}img/loading.gif" />
    </div>
    <ul id="embeds" class="oembedded" style="display: none;"></ul>
  </div>
</div>

<script language="javascript">
Dajaxice.sam.views.river.soundclouds(embed);
Dajaxice.sam.views.river.flickrs(embed);
Dajaxice.sam.views.river.twitters(embed);
Dajaxice.sam.views.river.githubs(embed);
Dajaxice.sam.views.river.lastfms(embed);
Dajaxice.sam.views.river.blogs(embed);
//Dajaxice.sam.views.river.imgurs(embed);
//Dajaxice.sam.views.river.facebooks(embed);
</script>

{% endblock %}
