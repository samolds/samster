{% extends 'base.html' %}

{% block content %}

<div class="body-normal">
{% if exists %}
  {% if post %}
    <div class="content">

      <table>
        <tr>
          <td class="textleft tdtitle" rowspan=2><h1>{{ post.title }}</h1></td>
          <td class="textright"><small>Created on {{ post.creation_date }}</small></td>
        </tr>
        {% if not post.creation_date.ctime == post.updated_date.ctime %}
          <tr>
            <td class="textright"><small>Updated on {{ post.updated_date }}</small></td>
          </tr>
        {% endif %}
      </table>

      <p class="textright"><small>Tags: 
        {% for tag_data in post.tags.values %}
          <a href="/blog/filter/{{ tag_data.tag }}">{{ tag_data.tag }}</a>
        {% endfor %}
      </small></p>

      <div class="content">
        <p>{{ post.content|safe }}</p>
        <div class="clear"></div>
        <br />

        {% if post.image.image %}
          <p><img src="/{{ post.image.image }}" /></p>
          <br />
        {% endif %}

        {% if post.embedded_link %}
          <p>{{ post.embedded_link|safe }}</p>
          <br />
        {% endif %}
      </div>
    </div>

    <div class="content inbetween"><br /><br /></div>
    <div class="content">
    <div class="content">
    <h1>Comments:</h1>
    </div>

    {% for comment_data in post.comments.values %}
      {% if not comment_data.private %}
        <div class="content">
          <table>
            <tr>
              <td class="textleft tdtitle" rowspan=2><h3>{{ comment_data.subject }}</h3></td>
              <td class="textright"><small>{{ comment_data.name }}</small></td>
            </tr>
            <tr>
              <td class="textright"><small>{{ comment_data.date }}</small></td>
            </tr>
          </table>
          <div class="content">{{ comment_data.message }}</div>
        </div>
      {% endif %}
    {% endfor %}

    <div class="content"></div>
    <div class="content"><h2>Leave a Comment</h2>
      <form action="/blog/post/{{ post.pk }}" method="post">{% csrf_token %}
          <div class="fieldWrapper">
          </div>
          {{ form.non_field_errors }}
          {% for field in form %}
              {% if field.name == "email_confirmation" %}
                  <div style="display: None;">
                      LEAVE BLANK {{ field }}
                  </div>
              {% else %}
                  <div class="fieldWrapper">
                      {{ field.label_tag }}{{ field }}
                      {% for error in field.errors %}
                          <strong class="alert">{{ error|escape }}</strong>
                      {% endfor %}
                  </div>
              {% endif %}
          {% endfor %}
          <input type="submit" value="Send" />
      </form>
    </div>
    </div>

  {% else %}
    <div class="content">
    <h1>This blog post has been marked as private!</h1>
    </div>
  {% endif %}
{% else %}
  <div class="content">
  <h1>This blog post has been moved or deleted! Oops.</h1>
  </div>
{% endif %}

<div class="content inbetween"></div>

<div class="content">
<a href="/blog">Back To Blog</a>
</div>
</div>

{% endblock %}
